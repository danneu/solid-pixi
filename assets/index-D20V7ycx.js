var u={},m={},x;function A(){return x||(x=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.GRAPH_HEIGHT=e.GRAPH_WIDTH=e.GRAPH_Y=e.FONT_SIZE=e.GRAPH_X=e.TEXT_Y=e.TEXT_X=e.HEIGHT=e.WIDTH=e.PR=void 0,e.PR=4,e.WIDTH=50*e.PR,e.HEIGHT=30*e.PR,e.TEXT_X=7,e.TEXT_Y=7,e.GRAPH_X=e.TEXT_X,e.FONT_SIZE=20,e.GRAPH_Y=e.FONT_SIZE+e.TEXT_Y,e.GRAPH_WIDTH=e.WIDTH-e.GRAPH_X*2,e.GRAPH_HEIGHT=e.HEIGHT-e.GRAPH_X-e.GRAPH_Y}(m)),m}var c={},G;function P(){if(G)return c;G=1,Object.defineProperty(c,"__esModule",{value:!0}),c.Panel=void 0;const e=A();class n{constructor(s,i,t){this.values=[],this.snapshotSize=30;const r=document.createElement("canvas");r.width=e.WIDTH,r.height=e.HEIGHT;const o=r.getContext("2d");if(!o)throw new Error("Cant get context on canvas");o.font=`bold ${e.FONT_SIZE}px ${getComputedStyle(document.body).fontFamily}`,o.textBaseline="top",o.fillStyle=t,o.fillRect(0,0,e.WIDTH,e.HEIGHT),o.fillStyle=i,o.fillText(s,e.TEXT_X,e.TEXT_Y),o.fillRect(e.GRAPH_X,e.GRAPH_Y,e.GRAPH_WIDTH,e.GRAPH_HEIGHT),o.fillStyle=t,o.globalAlpha=.8,o.fillRect(e.GRAPH_X,e.GRAPH_Y,e.GRAPH_WIDTH,e.GRAPH_HEIGHT),this.name=s,this.dom=r,this.context=o,this.fg=i,this.bg=t}get min(){return this.values.reduce((s,i)=>Math.min(s,i),1/0).toFixed()}get max(){return this.values.reduce((s,i)=>Math.max(s,i),0).toFixed()}get averageValue(){return(this.values.reduce((s,i)=>s+i,0)/this.values.length).toFixed(1)}pushValue(s){this.values.push(s),this.values.length>this.snapshotSize&&(this.values=this.values.slice(-this.snapshotSize))}update(s,i){const t=this.context;this.pushValue(s),t.fillStyle=this.bg,t.globalAlpha=1,t.fillRect(0,0,e.WIDTH,e.GRAPH_Y),t.fillStyle=this.fg,t.font=`bold ${e.FONT_SIZE}px ${getComputedStyle(document.body).fontFamily}`,t.fillText(`${this.averageValue} ${this.name} (${this.min}-${this.max})`,e.TEXT_X,e.TEXT_Y),t.drawImage(this.dom,e.GRAPH_X+e.PR,e.GRAPH_Y,e.GRAPH_WIDTH-e.PR,e.GRAPH_HEIGHT,e.GRAPH_X,e.GRAPH_Y,e.GRAPH_WIDTH-e.PR,e.GRAPH_HEIGHT),t.fillRect(e.GRAPH_X+e.GRAPH_WIDTH-e.PR,e.GRAPH_Y,e.PR,e.GRAPH_HEIGHT),t.fillStyle=this.bg,t.globalAlpha=.8,t.fillRect(e.GRAPH_X+e.GRAPH_WIDTH-e.PR,e.GRAPH_Y,2*e.PR,Math.round((1-s/i)*e.GRAPH_HEIGHT))}}return c.Panel=n,c}var _={},k;function D(){if(k)return _;k=1,Object.defineProperty(_,"__esModule",{value:!0}),_.StatsJSAdapter=void 0;const e=P();class n{constructor(s,i){this.hook=s,this.stats=i,this.hook.hooked&&(this.dcPanel=this.stats.addPanel(new e.Panel("DC","#f60","#300")),this.tcPanel=this.stats.addPanel(new e.Panel("TC","#0c6","#033")))}update(){var s,i;this.stats&&(this.hook&&((s=this.dcPanel)===null||s===void 0||s.update(this.hook.deltaDrawCalls,Math.max(50,this.hook.maxDeltaDrawCalls)),(i=this.tcPanel)===null||i===void 0||i.update(this.hook.texturesCount,Math.max(20,this.hook.maxTextureCount))),this.stats.update())}reset(){this.hook&&this.hook.reset()}}return _.StatsJSAdapter=n,_}var f={},h={},d={},H={},g;function E(){if(g)return H;g=1,Object.defineProperty(H,"__esModule",{value:!0});let e=class{constructor(a){this.drawPasses=0,this.isInit=!1,this.realGLDrawElements=function(){},a?a.__proto__.drawElements&&(this.gl=a,this.realGLDrawElements=this.gl.__proto__.drawElements,this.gl.__proto__.drawElements=this.fakeGLdrawElements.bind(this),this.isInit=!0,console.info("[GLHook] GL was Hooked!")):console.warn("[GLHook] GL can't be NULL")}fakeGLdrawElements(a,s,i,t){this.drawPasses++,this.realGLDrawElements.call(this.gl,a,s,i,t)}reset(){this.drawPasses=0}release(){this.isInit&&(this.gl.__proto__.drawElements=this.realGLDrawElements,console.info("[GLHook] Hook was removed!")),this.isInit=!1}};return H.default=e,H}var T={},v;function C(){if(v)return T;v=1,Object.defineProperty(T,"__esModule",{value:!0});let e=class{constructor(a){this.createdTextures=new Array,this.maxTexturesCount=0,this.isInit=!1,this.realGLCreateTexture=function(){},this.realGLDeleteTexture=function(){},a?a.__proto__.createTexture&&(this.gl=a,this.realGLCreateTexture=this.gl.__proto__.createTexture,this.realGLDeleteTexture=this.gl.__proto__.deleteTexture,this.gl.__proto__.createTexture=this.fakeGLCreateTexture.bind(this),this.gl.__proto__.deleteTexture=this.fakeGLDeleteTexture.bind(this),this.isInit=!0,console.info("[TextureHook] GL was Hooked!")):console.warn("[TextureHook] GL can't be NULL")}get currentTextureCount(){return this.createdTextures.length}registerTexture(a){this.createdTextures.push(a),this.maxTexturesCount=Math.max(this.createdTextures.length,this.maxTexturesCount)}fakeGLCreateTexture(){const a=this.realGLCreateTexture.call(this.gl);return this.registerTexture(a),a}fakeGLDeleteTexture(a){const s=this.createdTextures.indexOf(a);s>-1&&this.createdTextures.splice(s,1),this.realGLDeleteTexture.call(this.gl,a)}reset(){this.createdTextures=new Array,this.maxTexturesCount=0}release(){this.isInit&&(this.gl.__proto__.createTexture=this.realGLCreateTexture,this.gl.__proto__.deleteTexture=this.realGLDeleteTexture,console.info("[TextureHook] Hook was removed!")),this.isInit=!1}};return T.default=e,T}var w;function S(){if(w)return d;w=1;var e=d&&d.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(d,"__esModule",{value:!0});const n=e(E()),a=e(C());let s=class{constructor(){this._drawCalls=-1,this._maxDeltaDrawCalls=-1}attach(t){this.glhook=new n.default(t),this.texturehook=new a.default(t)}get drawCalls(){return this.glhook&&this.glhook.isInit?this.glhook.drawPasses:-1}get maxDeltaDrawCalls(){return this._maxDeltaDrawCalls}get deltaDrawCalls(){if(this._drawCalls==-1)return this._drawCalls=this.drawCalls,0;const t=this.drawCalls,r=t-this._drawCalls;return this._drawCalls=t,this._maxDeltaDrawCalls=Math.max(this._maxDeltaDrawCalls,r),r}get maxTextureCount(){return this.texturehook&&this.texturehook.isInit?this.texturehook.maxTexturesCount:0}get texturesCount(){return this.texturehook&&this.texturehook.isInit?this.texturehook.currentTextureCount:0}reset(){this._maxDeltaDrawCalls=-1,this._drawCalls=-1,this.glhook&&this.glhook.reset(),this.texturehook&&this.texturehook.reset()}release(){this.glhook&&this.glhook.release(),this.texturehook&&this.texturehook.release()}};return d.default=s,d}var p;function b(){if(p)return h;p=1;var e=h&&h.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(h,"__esModule",{value:!0}),h.PIXIHooks=void 0;const n=e(S());class a extends n.default{get hooked(){return!!this.glhook}constructor(i){if(super(),!i){console.warn("[PIXI Hooks] renderer in constructor undefined");return}if(!i.gl){console.warn("[PIXI Hooks] gl in renderer not found");return}if(this.attach(i.gl),!this.texturehook){console.warn("[PIXI Hooks] attach hook to gl in renderer failed");return}const t=i.texture,r=t._glTextures||t.managedTextures,o=Array.isArray(r)?r:Object.values(r);if(!o){console.warn("[PIXI Hooks] no gl textures found");return}console.info("[PIXI Hooks] Collect used textures:",o.length),o.forEach(l=>{l.gl===i.gl&&l.texture&&this.texturehook.registerTexture(l.texture)})}}return h.PIXIHooks=a,h}var I;function y(){if(I)return f;I=1,Object.defineProperty(f,"__esModule",{value:!0}),f.Stats=void 0;const e=b(),n=P(),a=D();class s{constructor(t,r=document.body,o){if(this.mode=0,this.frames=0,this.beginTime=(performance||Date).now(),this.prevTime=this.beginTime,this.domElement=document.createElement("div"),this.domElement.id="stats",this.domElement.addEventListener("click",l=>{l.preventDefault(),this.showPanel(++this.mode%this.domElement.children.length)},!1),this.fpsPanel=this.addPanel(new n.Panel("FPS","#3ff","#002")),this.msPanel=this.addPanel(new n.Panel("MS","#0f0","#020")),"memory"in performance&&(this.memPanel=this.addPanel(new n.Panel("MB","#f08","#200"))),this.pixiHooks=new e.PIXIHooks(t),this.adapter=new a.StatsJSAdapter(this.pixiHooks,this),this.showPanel(0),r.appendChild(this.domElement),"animations"in t)t.animations.push(()=>{this.adapter.update()});else if(o)o.add(()=>{this.adapter.update()});else{const l=()=>{this.adapter.update(),requestAnimationFrame(l)};l()}}addPanel(t){return this.domElement.appendChild(t.dom),t}showPanel(t){for(let r=0;r<this.domElement.children.length;r++){const o=this.domElement.children[r];o.style.display=r===t?"block":"none"}this.mode=t}begin(){this.beginTime=(performance||Date).now()}end(){this.frames++;const t=(performance||Date).now();if(this.msPanel.update(t-this.beginTime,200),t>this.prevTime+1e3&&(this.fpsPanel.update(this.frames*1e3/(t-this.prevTime),100),this.prevTime=t,this.frames=0,this.memPanel&&"memory"in performance)){const r=performance.memory;this.memPanel.update(r.usedJSHeapSize/1048576,r.jsHeapSizeLimit/1048576)}return t}update(){this.beginTime=this.end()}}return f.Stats=s,f}var R;function L(){return R||(R=1,function(e){var n=u&&u.__createBinding||(Object.create?function(s,i,t,r){r===void 0&&(r=t);var o=Object.getOwnPropertyDescriptor(i,t);(!o||("get"in o?!i.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return i[t]}}),Object.defineProperty(s,r,o)}:function(s,i,t,r){r===void 0&&(r=t),s[r]=i[t]}),a=u&&u.__exportStar||function(s,i){for(var t in s)t!=="default"&&!Object.prototype.hasOwnProperty.call(i,t)&&n(i,s,t)};Object.defineProperty(e,"__esModule",{value:!0}),a(A(),e),a(P(),e),a(D(),e),a(y(),e)}(u)),u}var q=L();export{q as d};
